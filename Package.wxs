<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">

  <Package
      Name="ExamSubmission"
      Manufacturer="CUNE"
      Version="1.0.0.1"
      UpgradeCode="{D2B77C9E-AB85-4F13-8B67-123456789ABC}"
      Scope="perMachine"
      Compressed="yes"
      InstallerVersion="500">

    <MediaTemplate EmbedCab="yes" />
    <MajorUpgrade DowngradeErrorMessage="A newer version is already installed." />

    <StandardDirectory Id="ProgramFilesFolder">
      <Directory Id="INSTALLFOLDER" Name="ExamSubmission"/>
    </StandardDirectory>

    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="ExamSubmission"/>
    </StandardDirectory>

    <Feature Id="MainFeature" Title="ExamSubmission" Level="1">
      <ComponentGroupRef Id="PublishComponents"/>
    </Feature>
  </Package>

  <Fragment>
    <!-- Harvest published files -->
    <ComponentGroup Id="PublishComponents" Directory="INSTALLFOLDER">
      <Files Include="$(var.PublishDir)\**\*.*"/>
    </ComponentGroup>
  </Fragment>

  <Fragment>
    <!-- Create a shortcut to ExamSubmission.exe in Start Menu -->
    <Component Id="StartMenuShortcut" Directory="ApplicationProgramsFolder">
      <Shortcut Id="StartMenuShortcut"
                Name="ExamSubmission"
                Target="[INSTALLFOLDER]ExamSubmission.exe"
                WorkingDirectory="INSTALLFOLDER" />
      <!-- Ensure uninstallation cleans up the shortcut -->
      <RemoveFolder Id="RemoveStartMenuFolder" Directory="ApplicationProgramsFolder" On="uninstall" />
      <RegistryValue Root="HKCU" Key="Software\ExamSubmission" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
    </Component>
  </Fragment>

</Wix>
